---
title: "Viva"
author: "Datalords"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_float: yes
    theme: journal
    highlight: pygments
    css: estilos.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```


# Librerias
```{r}
library(dplyr)
library(ggplot2)
library(dplyr)
library(readxl)
library(tidyr)
library(lubridate)
library(purrr)
library(plotly)
library(forecast)
library(readxl)
library(DataExplorer)
library(dplyr)
library(ggplot2)
library(tm)
library(wordcloud)
library(cluster)
library(factoextra) 
library(gridExtra)
library(purrr)
library(pROC)
library(rpart)
library(rpart.plot)
library(e1071)
library(ggpubr)
library(dlookr)
library(zoo)
library(caret)
library(stats)
library(tseries)
library(readr)
library(vars)
library(syuzhet)
library(kableExtra)
library(plotly)
library(scales)
library(readxl)
library(lubridate)
```


# Limpieza de datos
```{r}
ventas = read.csv("databases/Sales Tec_Valid.csv")
vuelos = read.csv("databases/Filghts Tec_Valid.csv")
```

## Vuelos
```{r}
head(vuelos)
summary(vuelos)
```

```{r}
vuelos$Origin_Type = as.factor(vuelos$Origin_Type)
vuelos$Destination_Type = as.factor(vuelos$Destination_Type)
#Ver si eliminar el registro ""
```

### Cancelación de los vuelos
```{r}
vuelos$Realizado <- ifelse(is.na(vuelos$Passengers), 1, 0)
vuelos$Realizado = as.factor(vuelos$Realizado)
```

### Variables Dia/Fecha
```{r}
### Salidas
vuelos$STD <- as.POSIXct(vuelos$STD, format = "%Y-%m-%d %H:%M:%S", na.rm = TRUE)
vuelos$STD_fecha <- as.Date(vuelos$STD)
vuelos$STD_hora <- format(vuelos$STD, "%H:%M:%S")

vuelos$STA <- as.POSIXct(vuelos$STA, format = "%Y-%m-%d %H:%M:%S", na.rm = TRUE)
vuelos$STA_fecha <- as.Date(vuelos$STA)
vuelos$STA_hora <- format(vuelos$STA, "%H:%M:%S")

vuelos$diferencia_horas <- as.numeric(difftime(vuelos$STA, vuelos$STD, units = "hours"))
vuelos$diferencia_minutos <- vuelos$diferencia_horas * 60

vuelos$STD_Dia_del_mes <- day(vuelos$STD_fecha)
vuelos$STD_Mes <- month(vuelos$STD_fecha, label = TRUE)
vuelos$STD_Año <- year(vuelos$STD_fecha)

vuelos$STA_Dia_del_mes <- day(vuelos$STA_fecha)
vuelos$STA_Mes <- month(vuelos$STA_fecha, label = TRUE)
vuelos$STA_Año <- year(vuelos$STA_fecha)
```

### Porcentajes
```{r}
vuelos <- vuelos %>%
  mutate(Porcentaje_Capacidad = (Passengers / Capacity) * 100,
         Porcentaje_Reservas = (Bookings/Capacity)*100)
```

### Join 
```{r}
df <- vuelos %>% 
  left_join(ventas, by = "Flight_ID")
```

```{r}
df_alt <- subset(df, select = -c(TotalSales, Aeronave))
```

## Ventas 





